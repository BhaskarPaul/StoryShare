"use strict";(self.webpackChunktry_firebase=self.webpackChunktry_firebase||[]).push([[999],{8999:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(5861),s=n(885),i=n(7757),a=n.n(i),o=n(2791),c=(n(3508),n(855)),u=n(8735),l=n(6871),d=n(6793),p=n(6910),f=n(2982),h=n(1413),x=n(3393),g=n(5798),v=n(6123),m=n(3445),j=n(7805),y=n(292),Z=n(9062),b=n(9373),S=n(2810),C=n(7279),k=n(8906),w=n(4453),E=function(e){var t=(0,o.useState)(0),n=(0,s.Z)(t,2),r=n[0],i=n[1],a=(0,o.useState)(null),c=(0,s.Z)(a,2),u=c[0],l=c[1],d=(0,o.useState)(null),p=(0,s.Z)(d,2),f=p[0],h=p[1];return(0,o.useEffect)((function(){var t=(0,w.cF)(k.l),n=(0,w.iH)(t,"images/"+e.name),r=(0,w.B0)(n,e);r.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;i(t)}),(function(e){l(e)}),(function(){(0,w.Jt)(r.snapshot.ref).then((function(e){return h(e)}))}))}),[e]),{progress:r,error:u,url:f}},I=n(184),P=function(e){var t=e.file,n=e.setFile,r=e.story,s=e.setStory,i=E(t),a=i.progress,c=i.url,u=i.error;return(0,o.useEffect)((function(){c&&(n(null),s((0,h.Z)((0,h.Z)({},r),{},{url:c}))),console.log(u)}),[c,n,u]),(0,I.jsx)("div",{children:(0,I.jsx)(C.Ex,{style:{borderRadius:"5px",marginTop:"10px"},value:a})})},F=n(2134),_=function(e){var t=e.creatorName,n=(0,l.s0)(),i=(0,o.useContext)(b.T),C=(0,o.useState)({heading:"",content:"",type:"public",url:""}),k=(0,s.Z)(C,2),w=k[0],E=k[1],_=(0,o.useState)(!1),N=(0,s.Z)(_,2),T=N[0],B=N[1],L=(0,p.F_)(y.I8),J=(0,s.Z)(L,3),R=J[0],X=(J[1],J[2],(0,o.useState)({visible:!1,message:""})),Y=(0,s.Z)(X,2),D=Y[0],H=Y[1],U=(0,o.useState)(!1),A=(0,s.Z)(U,2),O=A[0],Q=A[1],q=(0,o.useState)(null),z=(0,s.Z)(q,2),V=z[0],G=z[1],K=(0,c.ac)("(min-width: 1000px)"),M=(0,s.Z)(K,1)[0],W=(0,o.useState)(!1),$=(0,s.Z)(W,2),ee=$[0],te=$[1];(0,o.useEffect)((function(){""!==w.heading&&""!==w.content&&""!==w.url?B(!0):B(!1)}),[w]),(0,o.useEffect)((function(){R||n("/login",{replace:!0})}),[R]),(0,o.useEffect)((function(){M&&te(!0)}),[M]);var ne=function(){var e=(0,r.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q(!0),e.prev=1,n=(0,h.Z)((0,h.Z)({_id:R.uid,storyId:(0,S.Z)(),creatorName:t},w),{},{likes:0,views:0,createdAt:(0,y.H0)("c"),timestamp:Date.now()}),e.next=5,(0,Z.ET)((0,Z.hJ)(y.db,"stories"),n);case 5:i.setRootStories([n].concat((0,f.Z)(i.rootStories))),E({heading:"",content:"",type:"public"}),Q(!1),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),Q(!1),H({visible:!0,message:e.t0.message}),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return(0,I.jsxs)(I.Fragment,{children:[!M&&(0,I.jsxs)(u.Ug,{alignItems:"center",justifyContent:"center",className:"responsive-add-story",onClick:function(){return te(!ee)},style:{marginBottom:ee&&"30px"},children:[(0,I.jsx)("p",{children:ee?"Click here to close":"Click here to add story"}),!ee&&(0,I.jsx)("span",{children:(0,I.jsx)(F.QZL,{})})]}),ee&&(0,I.jsxs)("div",{className:"create-story",children:[D.visible&&(0,I.jsx)(d.Z,{message:D.message,handleClose:function(){return H({visible:!1,message:""})}}),(0,I.jsxs)(x.NI,{isRequired:!0,children:[(0,I.jsx)(x.lX,{htmlFor:"story-heading",children:"Heading"}),(0,I.jsx)(g.II,{id:"story-heading",type:"text",placeholder:"Your story heading...",value:w.heading,onChange:function(e){return E((0,h.Z)((0,h.Z)({},w),{},{heading:e.target.value}))}}),(0,I.jsx)(x.lX,{htmlFor:"story-content",children:"Content"}),(0,I.jsx)(v.g,{placeholder:"Your story content...",value:w.content,onChange:function(e){return E((0,h.Z)((0,h.Z)({},w),{},{content:e.target.value}))}}),(0,I.jsx)(x.lX,{htmlFor:"image",children:"Upload story image"}),(0,I.jsx)(g.II,{id:"image",type:"file",placeholder:"upload image here...",onChange:function(e){return function(e){var t=e.type;e&&["image/jpeg","image/jpg","image/png"].includes(t)?G(e):(H({visible:!0,message:"Image file type should be jpeg or png"}),G(null))}(e.target.files[0])}}),V&&(0,I.jsx)(P,{file:V,setFile:G,story:w,setStory:E}),(0,I.jsx)(x.lX,{as:"legend",children:"Select your story privacy"}),(0,I.jsx)(m.Ee,{defaultValue:w.type,onChange:function(e){return E((0,h.Z)((0,h.Z)({},w),{},{type:e}))},children:(0,I.jsxs)(u.Ug,{spacing:"24px",children:[(0,I.jsx)(m.Y8,{value:"public",children:"Public"}),(0,I.jsx)(m.Y8,{value:"private",children:"Private"})]})}),(0,I.jsx)(x.Q6,{children:"Default story type is Public"}),(0,I.jsx)(j.zx,{isLoading:O,disabled:!T,colorScheme:"teal",variant:"solid",onClick:ne,children:"Create story"})]})]})]})},N=n(7640),T=n(9547),B=function(){var e=(0,l.s0)(),t=(0,o.useContext)(b.T),n=(0,p.F_)(y.I8),i=(0,s.Z)(n,3),u=i[0],d=(i[1],i[2],(0,o.useState)("all")),f=(0,s.Z)(d,2),h=f[0],x=f[1],g=(0,c.ac)("(min-width: 1000px)"),v=(0,s.Z)(g,1)[0],m=function(){var e=(0,r.Z)(a().mark((function e(){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Z.PL)((0,Z.IO)((0,Z.hJ)(y.db,"stories"),(0,Z.ar)("_id","==",u.uid)));case 2:n=e.sent,r=[],n.forEach((function(e){return r.push(e.data())})),r.sort((function(e,t){return t.timestamp-e.timestamp})),t.setRootStories([].concat(r));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){u||e("/login",{replace:!0})}),[u]),(0,o.useEffect)((function(){m()}),[]),(0,I.jsxs)("div",{children:[(0,I.jsxs)(N.Ph,{placeholder:"Filter Stories (All)",onChange:function(e){return x(e.target.value)},style:{marginBottom:"30px",marginTop:!v&&"30px"},children:[(0,I.jsx)("option",{value:"public",children:"Public"}),(0,I.jsx)("option",{value:"private",children:"Private"})]}),t.rootStories.filter((function(e){return"public"===h||"private"===h?e.type===h:e})).map((function(e,t){return(0,I.jsx)(T.Z,{story:e,type:"user"},t)}))]})},L=n(1649),J=n(2575),R=function(){var e=(0,l.s0)(),t=(0,o.useState)({message:"",visible:!1}),n=(0,s.Z)(t,2),i=n[0],f=n[1],h=(0,o.useState)({}),x=(0,s.Z)(h,2),g=x[0],v=x[1],m=(0,p.F_)(y.I8),j=(0,s.Z)(m,3),b=j[0],S=j[1],C=(j[2],(0,c.ac)("(min-width: 1000px)")),k=(0,s.Z)(C,1)[0];(0,o.useEffect)((function(){b||e("/login")}),[b]),(0,o.useEffect)((function(){w()}),[]);var w=function(){var e=(0,r.Z)(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Z.PL)((0,Z.IO)((0,Z.hJ)(y.db,"users"),(0,Z.ar)("_id","==",null===b||void 0===b?void 0:b.uid)));case 3:return t=e.sent,e.next=6,t.docs[0].data();case 6:n=e.sent,v(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return S?(0,I.jsx)(J.BarLoader,{}):(0,I.jsxs)("div",{style:{overflow:"hidden"},children:[i.visible&&(0,I.jsx)(d.Z,{message:i.message,handleClose:function(){return f({visible:!1,message:""})}}),(0,I.jsx)(L.Z,{userData:g}),(0,I.jsx)("div",{className:"story-body",children:k?(0,I.jsxs)(u.rj,{templateColumns:k&&"repeat(5, 1fr)",gap:5,children:[(0,I.jsx)(u.P4,{colSpan:3,children:(0,I.jsx)(B,{})}),(0,I.jsx)(u.P4,{colSpan:2,children:(0,I.jsx)(_,{creatorName:g.name})})]}):(0,I.jsxs)(u.rj,{gap:5,children:[(0,I.jsx)(u.P4,{children:(0,I.jsx)(_,{creatorName:g.name})}),(0,I.jsx)(u.P4,{children:(0,I.jsx)(B,{})})]})})]})}}}]);
//# sourceMappingURL=999.fe8809a9.chunk.js.map